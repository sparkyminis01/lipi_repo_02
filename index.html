<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="LipiKit PWA - Modern productivity apps for business, personal, and travel needs">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ©Ô∏è</text></svg>">  
  <title id="page-title">LipiKit App</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#9333ea">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="appstyle.css">
  <style>
    /* Loading Spinner */
    #app-loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s ease-out;
    }
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #9333ea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 15px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .loading-text {
      color: #4a4a4a;
      font-size: 1.1em;
      margin-top: 10px;
    }
  </style>
  
  <!-- CryptoJS for PIN validation -->
  <script src="crypto-js.min.js"></script>
  
  <!-- Firebase SDK (v9 compat mode) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  
  <!-- Google AdSense -->
  <!--script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6822234477749633" crossorigin="anonymous"></script>-->
</head>
<body>
  <!-- Loading Spinner -->
  <div id="app-loading">
    <div class="spinner"></div>
    <div class="loading-text">Loading TRIPS...</div>
  </div>

  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo" onclick="location.reload()" style="cursor: pointer; user-select: none; display: flex; align-items: center; gap: 12px;">
        
        <div>
          <span class="company-name" id="company-name">LipiKit</span>
          <span class="app-name" id="app-name">Trips</span>
        </div>
      </div>
      <!-- Profile dropdown will be injected by profile-auth.js -->
    </header>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Settings</h2>
        <div id="common-settings"></div>
        <div id="app-settings"></div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="modal hidden">
      <div class="modal-content">
        <h2 id="confirmation-title">Confirm Action</h2>
        <p id="confirmation-message">Are you sure you want to proceed?</p>
        <div class="flex gap-2 mt-4">
          <button id="confirm-yes" class="btn btn-danger" style="flex:1;">Yes</button>
          <button id="confirm-no" class="btn btn-secondary" style="flex:1;">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Profile section (for sign-in UI) -->
    <div id="profile-section"></div>

    <!-- Main App -->
    <div id="app-area" class="hidden">
      <div class="card text-center">
        <h2>Welcome to Your App!</h2>
        <p>This area will be populated by app.js with your application logic.</p>
      </div>
    </div>

    <!-- Info Blocks -->
    <div class="info-grid">
      <div class="info-block" id="app-info-block"></div>
      <div class="info-block">
        <h2>LipiKit</h2>
        <h3>Productivity Apps for Everyone</h3>
        <p>Discover our suite of powerful apps designed for business, personal, and travel productivity.</p>
        <p>A curated collection of powerful, offline-first applications designed to enhance your productivity and simplify complex workflows.</p>
        <p>Built with modern web technologies and a focus on user experience, our apps deliver professional-grade functionality with consumer-friendly interfaces.</p>
        <a href="https://lipikit.com" class="btn btn-primary" target="_blank">Explore All Apps</a>
      </div>
      <div class="info-block">
        <div style="text-align: center; margin-bottom: 1.5rem;">
          <a href="https://sparkyminis.com" target="_blank" style="text-decoration: none;">
            <img src="logo.png" alt="SparkyMinis" style="height: 150px; width: auto; margin: 0 auto 1rem; display: block;">
            <h2 style="margin: 0; color: var(--primary-color);">SparkyMinis Media-Tech</h2>
          </a>
        </div>
        <p>We are SparkyMinis - Ethical AI Media-Tech for Nourished Lives</p>
        <p>Need help with your app? Want to suggest a new feature? Looking for business partnerships?</p>
        <p>Ready to ignite your project? Whether it's a custom AI workshop, media partnership. We're here to co-create intentional impact.</p>
        <a href="mailto:connect@sparkyminis.com" class="btn btn-success">Email Support</a>
        <a href="https://MadeByPriyanka.com" class="btn btn-secondary" target="_blank">Founder's Desk</a>
      </div>
      
    </div>

    <!-- FAQ -->
    <div class="faq-section">
      <h2>Frequently Asked Questions</h2>
      <div id="faq-container"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2025 SparkyMinis Media-Tech LLP. All Rights Reserved.</p>
    <div class="footer-links">
      <a href="https://lipikit.com" target="_blank">LipiKit App Catalog</a> |
      <a href="https://lipikit.com/privacy" target="_blank">Privacy</a> |
      <a href="https://lipikit.com/terms" target="_blank">Terms</a>
    </div>
    <p id="app-version"></p>
  </footer>

  <!-- Load app scripts -->
  <script>
    // Hide loading spinner when all scripts are loaded
    window.addEventListener('load', function() {
      // Small delay to ensure everything is properly initialized
      setTimeout(function() {
        const loading = document.getElementById('app-loading');
        if (loading) {
          loading.style.opacity = '0';
          setTimeout(() => loading.remove(), 300); // Match the transition duration
        }
      }, 500);
    });
  </script>
  <script src="config.js"></script>
  <script src="profile-auth.js"></script>
  <script src="settings.js"></script>
  <script src="appsettings.js"></script>
  <script src="dataset-manager.js"></script>
  <script src="faq.js"></script>
  <script src="app.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // Initialize core services
      if(typeof AppConfig!=='undefined') AppConfig.init();
      if(typeof ProfileManager!=='undefined') ProfileManager.init();
      if(typeof SettingsManager!=='undefined') SettingsManager.init();
      if(typeof AppSettingsManager!=='undefined') AppSettingsManager.init();
      if(typeof FAQManager!=='undefined'){
        FAQManager.init();
        FAQManager.addSearchBox();
      }
      if(typeof AppManager!=='undefined') AppManager.init();
    });

    // Helper functions for modals
    function showModal(id){
      document.getElementById(id).classList.remove('hidden');
    }
    
    function hideModal(id){
      document.getElementById(id).classList.add('hidden');
    }
    
    function showConfirmation(title, msg, onConfirm, onCancel=null){
      document.getElementById('confirmation-title').textContent = title;
      document.getElementById('confirmation-message').textContent = msg;
      const yesBtn = document.getElementById('confirm-yes');
      const noBtn = document.getElementById('confirm-no');
      yesBtn.replaceWith(yesBtn.cloneNode(true));
      noBtn.replaceWith(noBtn.cloneNode(true));
      document.getElementById('confirm-yes').addEventListener('click', () => {
        hideModal('confirmation-modal');
        if(onConfirm) onConfirm();
      });
      document.getElementById('confirm-no').addEventListener('click', () => {
        hideModal('confirmation-modal');
        if(onCancel) onCancel();
      });
      showModal('confirmation-modal');
    }
    
    // Close modals when clicking outside
    document.addEventListener('click', function(e){
      if(e.target.classList.contains('modal')){
        hideModal(e.target.id);
      }
    });
  </script>
  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then(registration => {
          console.log('Service Worker registered with scope:', registration.scope);
        }).catch(error => {
          console.log('Service Worker registration failed:', error);
        });
      });
    }
  </script>
</body>
</html>